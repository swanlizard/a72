ASMF:		CALL INIT
		MOV AX, 4200H
		XOR CX, CX
		XOR DX, DX
		MOV BX, [INFILE]
		INT 21H
		JC ASMFF
		CALL CALF
		MOV AX, [INFILE]
		MOV SI, OFFSET INFN
		CALL INCF
		MOV [STK+2], SP
ASMFL:		CALL RD
		JC ASMFF
		OR AX, AX
		JZ ASMF0
		MOV SI, [EOL]
		CALL ASM
		JC ASMER
		CALL WR
		JNC ASMFL
		CALL CLOSF
		MOV AX, OFFSET OUTFN
		JMP FFAIL
ASMFF:		CALL CLOSF
		MOV AX, OFFSET INFN
		JMP FFAIL
ASMF0:		OR WORD PTR [INCLEV], 0
		JZ ASMEND
		MOV AH, 3EH
		MOV BX, [INFILE]
		INT 21H
		DEC WORD PTR [INCLEV]
		CALL CALF
		MOV AX, OFFSET INPUT
		MOV [EOL], AX
		MOV [EOB], AX
		MOV AX, [DI]
		MOV [INFILE], AX
		JMP SHORT ASMFL
ASMER:		MOV SI, OFFSET ELEMENT
		CALL STOP
		JMP SHORT ASMFL
ASMEND:		XOR AX, AX
		CMP AX, [ERRS]
		RET
