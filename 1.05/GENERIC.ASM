CC:	XOR	BX,BX
CCM:	MOV	AL,[BX+SI]
	CMP	AL,0
	JZ	CCT
	CMP	AL,0DH
	JZ	CCT
	CMP	AL,21H
	JC	CCK
	CMP	AL,22H
	JZ	CCQ
	CMP	AL,27H
	JZ	CCQ
	CMP	AL,30H
	JC	CCS
	CMP	AL,3AH
	JC	CCL
	CMP	AL,3BH
	JZ	CCT
	CMP	AL,41H
	JC	CCS
	CMP	AL,5BH
	JC	CCL
	CMP	AL,5FH
	JZ	CCL
	CMP	AL,61H
	JC	CCS
	CMP	AL,7BH
	JNC	CCS
	AND	AL,0DFH
	MOV	[BX+SI],AL
CCL:	INC	BX
	JMP	SHORT CCM
CCK:	TEST	BX,BX
	JNZ	CCT
	INC	SI
	JMP	SHORT CCM
CCS:	TEST	BX,BX
	JZ	CCE
CCT:	MOV	AL,[SI]
	TEST	BX,BX
	RET
CCQ:	TEST	BX,BX
	JNZ	CCT
CCW:	INC	BX
	CMP	AL,[BX+SI]
	JNZ	CCW
CCE:	INC	BX
	RET
AA:	CMP	AX,80H
	JC	AA1
	CMP	AX,0FF80H
	RET
AA1:	CMC
	RET
SL:	MOV	DX,[DI]
	STC
	SBB	CX,CX
SL1:	ADD	DI,3
	ADD	DI,CX
	DEC	DX
	JS	SL4
	XOR	CH,CH
	MOV	CL,[DI]
	CMP	CL,BL
	JNZ	SL1
SL2:	MOV	AL,[BX+DI]
	AND	AL,7FH
	DEC	BX
	JS	SL3
	XOR	AL,[BX+SI]
	JZ	SL2
	MOV	BX,CX
	JNZ	SL1
SL3:	MOV	BX,CX
	MOV	AX,[BX+DI+1]
	ADD	SI,BX
	XOR	BX,BX
SL4:	RET
HALX:	PUSH	AX
	SHR	AL,1
	SHR	AL,1
	SHR	AL,1
	SHR	AL,1
	CALL	HALL
	POP	AX
HALL:	AND	AL,0FH
	OR	AL,30H
	CMP	AL,3AH
	JC	$+4
	ADD	AL,7
	STOSB
	RET
RN:	CLD
	CBW
	CWD
	CMP	CL,5
	JNC	RN4
	CMP	CL,1
	JC	RN0
RN1:	LODSB
	SUB	AL,30H
	JC	RN0
	CMP	AL,0AH
	JC	RN2
	SUB	AL,7
RN2:	CMP	AL,10H
	JNC	RN0
	SHL	DX,CL
	OR	DL,AL
	DEC	BX
	JNZ	RN1
RN3:	ADD	SI,BX
	XCHG	AX,DX
	CLC
	RET
RN4:	LODSB
	SUB	AL,30H
	JC	RN0
	CMP	AL,0AH
	JNC	RN0
	SHL	DX,1
	MOV	CX,DX
	SHL	DX,1
	SHL	DX,1
	ADD	DX,CX
	ADD	DX,AX
	DEC	BX
	JNZ	RN4
	JMP	SHORT RN3
RN0:	STC
	RET
WN:	CLD
	CMP	AX,CX
	JNC	WN1
	CMP	AX,10
	JNC	WN1
	OR	AL,30H
	STOSB
	RET
WN1:	MOV	SI,DI
WN2:	XOR	DX,DX
	DIV	CX
	XCHG	AX,DX
	CMP	AL,10
	SBB	AL,105
	DAS
	STOSB
	XCHG	AX,DX
	TEST	AX,AX
	JNZ	WN2
	CMP	DL,58
	JC	WN5
	MOV	AL,48
	STOSB
WN5:	MOV	CX,DI
	SUB	CX,SI
	SHR	CX,1
	JZ	WN0
	SUB	DI,CX
	ADD	SI,CX
WN4:	DEC	SI
	MOV	AL,[DI]
	XCHG	[SI],AL
	STOSB
	LOOP	WN4
WN0:	RET
LBL:	CALL	CC
	MOV	AL,[FUNC]
	AND	AL,3
	JZ	LBL2
	MOV	DI,[SYM]
	CALL	SL
	JNS	LBL3
	CLD
	MOV	AL,BL
	STOSB
	MOV	CX,BX
	REPZ	MOVSB
	MOV	BX,[SYM]
	INC	WORD [BX]
LBL1:	MOV	BP,DI
	MOV	AX,[PC]
	ADD	AX,[VORG]
	STOSW
	XOR	BX,BX
LBL2:	ADD	SI,BX
	CALL	CC
	JZ	ERR3
	CMP	AL,3AH
	JNZ	$+3
	INC	SI
	RET
LBL3:	ADD	DI,CX
	INC	DI
	MOV	AL,[FUNC]
	AND	AL,2
	JNZ	LBL1
	MOV	AL,0AH
	JMP	FAIL
ERR3:	MOV	AL,3
	JMP	FAIL
SETDFB:	MOV	DI,[BINBUF]
SETD1:	CALL	CC
	JZ	ERR8
	CMP	AL,3FH
	JZ	SETD5
	TEST	CL,CL
	JZ	SETD2
	XOR	AX,AX
	XCHG	CH,AH
	REPZ	STOSB
	MOV	CH,AH
SETD2:	CMP	AL,22H
	JZ	SETD6
	CMP	AL,27H
	JZ	SETD6
SETD3:	PUSH	CX
	PUSH	DI
	CALL	RI
	POP	DI
	POP	CX
	MOV	AX,[IMM]
	STOSW
	CMP	CH,2
	JZ	SETD7
	JNC	SETD4
	DEC	DI
	JMP	SHORT SETD7
SETD4:	SHL	AX,1
	SBB	AL,AL
	PUSH	CX
	XCHG	CH,CL
	SUB	CL,2
	REPZ	STOSB
	POP	CX
	JMP	SHORT SETD7
SETD5:	ADD	CL,CH
	INC	SI
	JMP	SHORT SETD7
SETD6:	CMP	BL,4
	JC	SETD3
	PUSH	CX
	MOV	CX,BX
	SUB	CX,2
	INC	SI
	REPZ	MOVSB
	POP	CX
	INC	SI
SETD7:	CALL	CC
	JZ	SETD8
	CMP	AL,2CH
	JNZ	ERR1
	INC	SI
	JMP	SHORT SETD1
SETD8:	XOR	CH,CH
	ADD	[USIZE],CX
	ADD	[PC],CX
	MOV	CX,DI
	SUB	CX,[BINBUF]
	ADD	[BINLEN],CX
	CLC
	RET
ERR8:	MOV	AL,8
	JMP	SHORT FAIL
ERR1:	MOV	AL,1
FAIL:	MOV	SP,[STK]
	CMP	AL,5
	JNZ	FAIL0
	MOV	DX,[IMM]
	TEST	DX,DX
	JNS	FAIL1
	NEG	DX
	DEC	DX
FAIL1:	SUB	DX,7FH
FAIL0:	STC
	RET
SETINC:	CALL	CC
	JZ	ERR8
	CMP	AL,22H
	JZ	SETIN1
	CMP	AL,27H
	JNZ	SETIN2
SETIN1:	INC	SI
	SUB	BX,2
	JBE	ERR8
	RET
SETIN2:	XOR	BX,BX
SETIN3:	INC	BX
	MOV	AL,[BX+SI]
	CMP	AL,3BH
	JZ	SETIN4
	CMP	AL,21H
	JNC	SETIN3
SETIN4:	RET
GVQ:	MOV	DX,[SI+1]
	ADD	SI,BX
	CMP	BX,5
	JNC	GV7
	CMP	BX,4
	JNC	GVV
	CMP	BX,3
	JC	GV8
	XOR	DH,DH
	JMP	SHORT GVV
GV4:	MOV	AL,4
	JMP	FAIL
GV7:	MOV	AL,7
	JMP	FAIL
GV8:	MOV	AL,8
	JMP	FAIL
GV:	TEST	CL,40H
	JNZ	GVA
	CMP	AL,DL
	JZ	GVC
	CMP	AL,22H
	JZ	GVQ
	CMP	AL,27H
	JZ	GVQ
	CALL	RNM
	JNC	GV
	CALL	RNC
	JNC	GVV
	CMP	AL,40H
	JC	GVA
	PUSH	CX
	MOV	DI,[SYM]
	CALL	SL
	POP	CX
	JNS	GVL
	MOV	AL,[FUNC]
	AND	AL,2
	JNZ	GV4
GVC:	ADD	SI,BX
	OR	CL,1
	MOV	DX,[PC]
	ADD	DX,[VORG]
	JMP	SHORT GVV
GVA:	STC
	RET
GVL:	XCHG	DX,AX
	TEST	DH,DH
	JNZ	GVL2
	MOV	AL,[FUNC]
	AND	AL,3
	JZ	GVL2
	MOV	AH,80H
	INC	DI
	AND	AL,1
	JZ	GVL1
	OR	[DI],AH
GVL1:	TEST	[DI],AH
	JNZ	GVV
GVL2:	OR	CL,2
GVV:	OR	CL,40H
	TEST	CL,CL
	JNS	GVNS
	AND	CL,7FH
	NEG	DX
GVNS:	TEST	CL,10H
	JNZ	GVWO
	TEST	CL,8
	JNZ	GVHB
	TEST	CL,4
	JNZ	GVLB
	JMP	SHORT GVWO
GVHB:	TEST	CL,4
	JNZ	GVWO
	XCHG	DL,DH
GVLB:	XOR	DH,DH
	AND	CL,0FCH
GVWO:	MOV	AX,DX
	CLC
	RET
RE:	XOR	CL,CL
	XOR	AX,AX
	MOV	[IMM],AX
REA:	CALL	CC
	JZ	RED
	CMP	AL,2BH
	JZ	REC
	CMP	AL,2DH
	JZ	REB
	PUSH	DX
	CALL	GV
	POP	DX
	JC	RED
	ADD	[IMM],AX
	JMP	SHORT REA
REB:	XOR	CL,80H
REC:	AND	CL,0BFH
	INC	SI
	JMP	SHORT REA
RED:	TEST	CL,40H
	JZ	RE8
	MOV	AX,[IMM]
	RET
RE8:	MOV	AL,8
	JMP	FAIL
